@startuml
actor Sanitario
actor Médico
actor Paciente
actor SistAvisos

activate Sanitario

Sanitario -> ClinicaFIS : IniciarConsulta()

alt primeraVisita
	Sanitario -> Paciente : informacion = PreguntarInfo()
	Sanitario -> ClinicaFIS : CrearHC(informacion)
end

Sanitario -> ClinicaFIS : AbrirHC()

Sanitario -> Paciente : resultados = ExplorarPaciente()

Sanitario -> ClinicaFIS : AñadirDatosClínicos(resultados)

alt curaNecesaria
	Sanitario -> Paciente : Cura()
end


alt necesitaMedicamento
	Médico -> ClinicaFIS : medicamento = RecetarMedicamento()
	activate Médico
	activate ClinicaFIS
	ClinicaFIS --> Paciente : DevolverReceta(medicamento)
	deactivate ClinicaFIS
end

alt necesitaTratamiento
	Médico -> Paciente : ImponerTratamiento()
end

alt necesitaPrueba
	Médico -> ClinicaFIS : prueba = PedirPrueba()
	activate ClinicaFIS
	ClinicaFIS --> Paciente : AsignarPrueba(prueba)
	deactivate ClinicaFIS
end

alt necesitaEspecialista
	Médico -> Paciente : DesviarAEspecialista()
	deactivate Médico
end

Sanitario -> ClinicaFIS : TerminarConsulta()
deactivate Sanitario

activate ClinicaFIS
ClinicaFIS --> SistAvisos : LlamarSiguientePaciente()
deactivate ClinicaFIS

@enduml
